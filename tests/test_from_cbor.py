from tx_simulation import from_cbor


def test_from_cbor_tx1():
    valid_hex_cbor = '84aa00818258206681d3f753d56d425e39badc82a14e269454249ee4fed5f3fff0516f63416858020d818258206e34390c14ea8041c85963cf4b00a4ac900ebfd4e7bbcc9df7ed9345393777f3001282825820e7e7ff77509721b79e2d9dbda5b1584c16a1e2a87769b4b9819697e8f18d729f01825820f60de32b7cf065e9f182d701078f0b310b965abdb5ca0cc24eb18dc4271c961d000183a300583930b0e5f6be155bcd5134eff29601a8a45c2c755c5a4228134ec159da72e8fc142c2bdc279274b4cbc98b4b4d1b2b1fde91743ced2c8daaefcc01821a0014c828a1581c92158340b4f3147aea48dd4bdb961878ec56f51f4cf4786a4490cf4ea15820000643b002d382ac922b700f41dc28ba47118421c42d845e7ba63044a6ce1f0201028201d8184fd8799fa145696d616765425fff01ffa3005839308a141f3e7a4f15f5e9ca335f7e14796d8bdfb3fd8c017459ef631d5de8fc142c2bdc279274b4cbc98b4b4d1b2b1fde91743ced2c8daaefcc01821a002dd6f6a1581c92158340b4f3147aea48dd4bdb961878ec56f51f4cf4786a4490cf4ea15820001bc28002d382ac922b700f41dc28ba47118421c42d845e7ba63044a6ce1f021a05f5e100028201d818589fd8799fd8799f581c39f29cfe6ab0765578a6e0d8871e1a3bc18f5d277b257095aabf1cd840ffd8799f581c92158340b4f3147aea48dd4bdb961878ec56f51f4cf4786a4490cf4e5820001bc28002d382ac922b700f41dc28ba47118421c42d845e7ba63044a6ce1f021a000f4240ffa1581c015d83f25700c83d708fbf8ad57783dc257b01a932ffceac9dcd0c3da14843757272656e63791a001e84800affa200581d60e6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd011a040afaea10a200581d60e6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd011a0092b9d8111a0005dca8021a0003e8700e82581cb834fb41c45bd80e5fd9d99119723637fe9d1e3fc467bc1c57ae9aee581ce6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd09a1581c92158340b4f3147aea48dd4bdb961878ec56f51f4cf4786a4490cf4ea25820000643b002d382ac922b700f41dc28ba47118421c42d845e7ba63044a6ce1f02015820001bc28002d382ac922b700f41dc28ba47118421c42d845e7ba63044a6ce1f021a05f5e1000b5820e1bddf15f5b3a7ab0aa0ef4a06c5ddadc45b7f03ec7a5e5aabdbdf34a3ee4ac0a10581840100d87980821a0006ebf31a0a3d16f9f5f6'
    output = from_cbor(valid_hex_cbor, False)
    expected_output = [{'mem': 453619, 'cpu': 171775737}]
    assert output == expected_output


def test_from_cbor_tx2():
    valid_hex_cbor = '84a9008282582032e9634fcb724e26cb12d3f00e3c4f4eb4214caa5032f8f933f4e6c1f78fa0f3008258206681d3f753d56d425e39badc82a14e269454249ee4fed5f3fff0516f63416858020d818258206e34390c14ea8041c85963cf4b00a4ac900ebfd4e7bbcc9df7ed9345393777f30012828258205eb433065a423b53b465bb02430e1d3c6d4547fa1c2a4d82367d4e53df9bef5b01825820f60de32b7cf065e9f182d701078f0b310b965abdb5ca0cc24eb18dc4271c961d000182a200581d6039f29cfe6ab0765578a6e0d8871e1a3bc18f5d277b257095aabf1cd801821a0013669aa1581c92158340b4f3147aea48dd4bdb961878ec56f51f4cf4786a4490cf4ea15820000643b001e77f1930e631ee5dda454786a974ab69154cff0f71c9d0cb76f69501a200581d60e6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd011a080431e710a200581d60e6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd011a00935936111a00053d4a021a00037e310e82581cb834fb41c45bd80e5fd9d99119723637fe9d1e3fc467bc1c57ae9aee581ce6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd0b5820cd45e9822fcd789bc1e6c34192691241c0fc1a8b7c21be031542bd5be3846d7aa10581840000d87980821a00055c621a08177250f5f6'
    output = from_cbor(valid_hex_cbor, False)
    expected_output = [{'mem': 351330, 'cpu': 135552944}]
    assert output == expected_output


def test_from_cbor_tx3():
    valid_hex_cbor = '84a900828258200b5d93ee6482f42a2e5d21d8d5496b2e7e09dce787d4ed5401fed153af08d7b600825820589a17a9fba2c3fd4a4ef324ea7cc6d37b0d03314a25e04147f4f7dacc1a4f1b010d818258206e34390c14ea8041c85963cf4b00a4ac900ebfd4e7bbcc9df7ed9345393777f30012828258208f457077d56938420978dd2c47f1cf8cc0f5e0339b8e066b9c4ca63df086e15e01825820f60de32b7cf065e9f182d701078f0b310b965abdb5ca0cc24eb18dc4271c961d000182a200581d602d5fec7bbb8abbe1fb6590db2676389dffab196d212fb2b4b9902dcc01821a00400ed4a2581c015d83f25700c83d708fbf8ad57783dc257b01a932ffceac9dcd0c3da14843757272656e63791a001e8480581c698a6ea0ca99f315034072af31eaac6ec11fe8558d3f48e9775aab9da14574445249501a000f4240a200581d602d5fec7bbb8abbe1fb6590db2676389dffab196d212fb2b4b9902dcc011a76c2f34a10a200581d602d5fec7bbb8abbe1fb6590db2676389dffab196d212fb2b4b9902dcc011a00932570111a00057110021a0003a0b50e82581c2d5fec7bbb8abbe1fb6590db2676389dffab196d212fb2b4b9902dcc581cb834fb41c45bd80e5fd9d99119723637fe9d1e3fc467bc1c57ae9aee0b5820a25626d921a18ec23871bed8e6173d36cd73dbfae748fa96d7bf76f72e95b292a10581840000d87b80821a0006c5081a0a3a6c3df5f6'
    output = from_cbor(valid_hex_cbor, False)
    expected_output = [{'mem': 443656, 'cpu': 171399581}]
    assert output == expected_output


def test_from_cbor_tx4():
    valid_hex_cbor = '84aa008282582015831d0c1396c7fa5b2db00f0a1d7f8aceec2d2c66ae4072239c859b23c0369201825820a0c1b6cbf657eae7cfec8c4c80daacd5e46369b3cf017d65f5aed6a4a9d6ada6010d818258206e34390c14ea8041c85963cf4b00a4ac900ebfd4e7bbcc9df7ed9345393777f30012838258202ca1a308f99fef3c8e42856b54f58552a26f63ce068467f0c8723083791c8bf3018258206258539869f5b0fca8e37723eb2ef998b215b1a549f5cc76aef8b3ef5773548f00825820f44a37ac4ba92afa57159249756e8cdc6e90505cb16a8735944057ac9e667ef3010181a200581d6039f29cfe6ab0765578a6e0d8871e1a3bc18f5d277b257095aabf1cd801821a08b8273ea1581c3d78e4d30a03db557222a66df75f9a9053ce7c44f9fb13487b2aacfaa15820001bc280005b86204c152f84ee3632ba2273a0b049b4f11da473ea92d3327d1f1a05f5e10010a200581d6039f29cfe6ab0765578a6e0d8871e1a3bc18f5d277b257095aabf1cd8011a00922820111a00066e60021a000449950e82581c39f29cfe6ab0765578a6e0d8871e1a3bc18f5d277b257095aabf1cd8581cb834fb41c45bd80e5fd9d99119723637fe9d1e3fc467bc1c57ae9aee09a1581c376116a19fc99e047e88d4253e7506d08c348c8f5190f68bfa1ad710a158200022bfb0005b86204c152f84ee3632ba2273a0b049b4f11da473ea92d3327d1f200b58206acca6a0b0b86f2439aa837b0d23223d2247736afe7d995d709278bbeb24e8eba10582840000d87c80821a0008ad9f1a0cb35523840100d87a9f00ff821a000570ab1a07ee4071f5f6'
    output = from_cbor(valid_hex_cbor, False)
    expected_output = [{'mem': 568735, 'cpu': 212877955}, {'mem': 356523, 'cpu': 133054577}]
    assert output == expected_output


def test_from_cbor_tx5():
    # this should not fail
    valid_hex_cbor = '84a80081825820e1e34201df22fe73cb4b0f68d417980ef43fc63c7d2be4e0193ac5181eca05bf010d818258206e34390c14ea8041c85963cf4b00a4ac900ebfd4e7bbcc9df7ed9345393777f30012838258202ca1a308f99fef3c8e42856b54f58552a26f63ce068467f0c8723083791c8bf3018258206258539869f5b0fca8e37723eb2ef998b215b1a549f5cc76aef8b3ef5773548f00825820f44a37ac4ba92afa57159249756e8cdc6e90505cb16a8735944057ac9e667ef3010181a300583930761d4a1bb1d913ce8ee9ba5764005b379aeb176d0e836c3a4e952ae4a2a2022676258ceb38ddfed9635685180e0c73eeec7f37be81f972ca01821a0028a275a2581c376116a19fc99e047e88d4253e7506d08c348c8f5190f68bfa1ad710a158200022bfb001dfd18936ae502db711bbc15c462efeb1bf451988d26e36605091b901581c3d78e4d30a03db557222a66df75f9a9053ce7c44f9fb13487b2aacfaa15820001bc2800160a7fad7b9dcefab28ea4b3e8c1399bf76accde9d2459bb2bf27181a05f5e100028201d818589fd8799fd8799f581c39f29cfe6ab0765578a6e0d8871e1a3bc18f5d277b257095aabf1cd840ffd8799f581c3d78e4d30a03db557222a66df75f9a9053ce7c44f9fb13487b2aacfa5820001bc2800160a7fad7b9dcefab28ea4b3e8c1399bf76accde9d2459bb2bf27181a000f4240ffa1581c015d83f25700c83d708fbf8ad57783dc257b01a932ffceac9dcd0c3da14843757272656e63791a001e84800aff021a000534810e82581cb834fb41c45bd80e5fd9d99119723637fe9d1e3fc467bc1c57ae9aee581ce6f85717b932788e3b1e57b11e9f8bf190d257c57d369979c18a02dd09a1581c376116a19fc99e047e88d4253e7506d08c348c8f5190f68bfa1ad710a158200022bfb001dfd18936ae502db711bbc15c462efeb1bf451988d26e36605091b9010b582099f9854034264c8669f50868e107f3cbe39f7396ea81842116c69b9b1fce3ddba10582840000d87a9fa1581c376116a19fc99e047e88d4253e7506d08c348c8f5190f68bfa1ad710a158200022bfb001dfd18936ae502db711bbc15c462efeb1bf451988d26e36605091b901ff821a000f42401a14dc9380840100d87980821a0007a1201a08f0d180f5f6'
    output = from_cbor(valid_hex_cbor, False, True)
    expected_output = [{}]
    assert output == expected_output
